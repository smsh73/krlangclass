# 테스트 가이드

## 테스트 개요

이 프로젝트는 다음 테스트를 포함합니다:

1. **스키마 일관성 테스트**: 데이터베이스 스키마와 코드 간의 일관성 검증
2. **스키마 사용 테스트**: Prisma 모델 사용 패턴 검증
3. **기능 테스트**: 핵심 기능들의 정상 작동 확인
4. **UI 컴포넌트 테스트**: 컴포넌트 구조 및 import 검증
5. **통합 테스트**: 전체 워크플로우 검증

## 테스트 실행

### 사전 요구사항

1. 데이터베이스 연결 설정 (`.env` 파일에 `DATABASE_URL` 설정)
2. 의존성 설치: `npm install`

### 개별 테스트 실행

```bash
# 스키마 일관성 테스트
npm run test:schema

# 스키마 사용 테스트
npm run test:schema-usage

# 기능 테스트
npm run test:functionality

# UI 컴포넌트 테스트
npm run test:ui

# 통합 테스트
npm run test:integration
```

### 전체 테스트 실행

```bash
# npm 스크립트 사용
npm run test:all

# 또는 셸 스크립트 사용
./scripts/run-all-tests.sh
```

## 테스트 결과 해석

### 성공 표시
- ✓ (체크마크): 테스트 통과

### 경고 표시
- ⚠ (경고): 문제가 될 수 있지만 치명적이지 않음

### 실패 표시
- ✗ (X 표시): 테스트 실패, 수정 필요

## 테스트 상세

### 1. 스키마 일관성 테스트

검증 항목:
- 모든 Prisma 모델 접근성
- 관계(Relations) 정상 작동
- 필수 필드 검증
- 제약 조건 (unique, foreign key)
- 데이터 타입 검증
- JSON 필드 처리

### 2. 스키마 사용 테스트

검증 항목:
- 스키마에 정의된 모델이 코드에서 사용되는지
- 코드에서 사용하는 모델이 스키마에 정의되어 있는지
- 필드명 일관성

### 3. 기능 테스트

검증 항목:
- 사용자 생성 및 인증
- 세션 관리
- 게임 점수 저장 및 조회
- 관리자 인증
- 커리큘럼 관리
- 레벨 테스트
- 대화형 세션
- 관리자 설정

### 4. UI 컴포넌트 테스트

검증 항목:
- 컴포넌트 파일 구조
- Export/Import 정확성
- 'use client' 지시어 (필요한 경우)
- UI 컴포넌트 존재 확인

### 5. 통합 테스트

검증 항목:
- 전체 사용자 워크플로우
- 관리자 워크플로우
- 데이터 무결성 (Cascade 삭제)
- 동시성 처리
- 복잡한 JSON 구조 처리

## 테스트 데이터

테스트는 실제 데이터베이스에 테스트 데이터를 생성합니다.
테스트 완료 후 자동으로 정리됩니다.

**주의**: 프로덕션 데이터베이스에서는 실행하지 마세요!

## 문제 해결

### 데이터베이스 연결 오류
- `.env` 파일에 `DATABASE_URL`이 올바르게 설정되어 있는지 확인
- 데이터베이스 서버가 실행 중인지 확인

### 테스트 실패
- 에러 메시지를 확인하고 해당 부분을 수정
- 데이터베이스 마이그레이션이 최신인지 확인: `npm run db:migrate`

### 타입 오류
- Prisma 클라이언트 재생성: `npm run db:generate`
